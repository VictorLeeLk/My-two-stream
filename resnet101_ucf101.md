### Resnet101

**1、空域**



在新的网络框架下空域网络训练，主要是ResNet101.**

- 主要包括空域中使用ImageNet预训练网络模型ResNet101,在UCF101数据集上迁移学习。

  在此次训练及测试中采用已经迁移好的网络权值初始化网络，在这个基础上进行训练或者评估。

  训练集:共9537个视频，每一个视频采样三帧数据进行训练，最终得到视频层次的训练结果。

  测试集:共3783个视频，每个视频采样19帧。

- 数据增强技术包括随机裁剪、水平翻转等

- 基本参数如下:

  ```
  初始lr=0.0005,momentum=0.9；
  loss-function：交叉熵损失
  优化器:随机梯度下降算法
  ```

   使用已经预训练好的网络权值文件，对网络进行训练，训练4个epoch的结果如下：

  | Epoch | Batch Time | Loss    | Prec@1                | Prec@5 |
  | ----- | ---------- | ------- | --------------------- | ------ |
  | 31    | 1.498      | 2.97748 | 78.773                | 95.453 |
  | 32    | 0.542      | 2.87651 | $\color{red}{79.461}$ | 95.4   |
  | 33    | 0.798      | 3.10699 | 78.139                | 95.189 |
  | 34    | 0.703      | 3.03346 | 78.271                | 95.506 |

  使用该网络权值，仅仅对测试集进行预测，得到的正确值为

     **Loss [2.54623] Prec@1 [$\color{red}{81.258}$] Prec@5 [95.929] **

  空域的识别准确率最高可以达到81.258%

#### 2、时域

```
python motion_cnn.py --resume ./resnet-101-temporal.tar --evaluate
```

```
Namespace(batch_size=32, epochs=500, evaluate=True, lr=0.01, resume='./resnet-101-temporal.tar', start_epoch=0)
==> (Training video, Validation video):( 9537 3783 )
==> Training data : 9537  videos (20L, 224L, 224L)
==> Validation data : 71877  frames (20L, 224L, 224L)
==> Build model and setup loss and optimizer
==> loading checkpoint './resnet-101-temporal.tar'
==> loaded checkpoint './resnet-101-temporal.tar' (epoch 29) (best_prec1 79.6722183228)
==> Epoch:[0/500][validation stage]
 45%|███████████████▌                   | 1003/2247 [2:23:26<2:57:54,  8.58s/it]100%|█████████████████████████████████████| 2247/2247 [5:18:18<00:00,  8.50s/it]
Time [8.499] 
Loss [7.01446] Prec@1 [79.672] Prec@5 [95.374] 
==> Epoch:[29/500][training stage]
100%|█████████████████████████████████████████| 299/299 [51:27<00:00, 10.33s/it]
Time [10.327] Data [9.919] 
Loss [0.53663] Prec@1 [84.9953] Prec@5 [96.9907]
LR 1e-08
==> Epoch:[29/500][validation stage]
100%|█████████████████████████████████████| 2247/2247 [5:06:22<00:00,  8.18s/it]
Time [8.181] 
Loss [7.76965] Prec@1 [78.192] Prec@5 [94.819] 
==> Epoch:[30/500][training stage]
100%|█████████████████████████████████████████| 299/299 [51:30<00:00, 10.34s/it]
Time [10.337] Data [9.966] 
Loss [0.53462] Prec@1 [85.0058] Prec@5 [97.106]
LR 1e-08
==> Epoch:[30/500][validation stage]
100%|█████████████████████████████████████| 2247/2247 [4:50:33<00:00,  7.76s/it]
Time [7.759] 
Loss [7.85516] Prec@1 [78.165] Prec@5 [94.792] 
==> Epoch:[31/500][training stage]
100%|█████████████████████████████████████████| 299/299 [52:11<00:00, 10.47s/it]
Time [10.473] Data [10.108] 
Loss [0.54238] Prec@1 [84.4605] Prec@5 [97.0536]
LR 1e-08
==> Epoch:[31/500][validation stage]
100%|█████████████████████████████████████| 2247/2247 [4:50:41<00:00,  7.76s/it]
Time [7.762] 
Loss [7.33458] Prec@1 [78.536] Prec@5 [94.978] 
==> Epoch:[32/500][training stage]
100%|█████████████████████████████████████████| 299/299 [51:07<00:00, 10.26s/it]
Time [10.261] Data [9.672] 
Loss [0.53283] Prec@1 [85.4147] Prec@5 [97.0012]
LR 1e-08
==> Epoch:[32/500][validation stage]
 25%|████████▉                           | 560/2247 [1:15:33<3:47:38,  8.10s/it]
```





train一个epoch的时间达到了51分钟，在测试一个epoch时间达到了4个小时50分钟。

█████████████████████████████████████| 2247/2247 [5:18:18<00:00,  8.50s/it]
Time [8.499] 
Loss [7.01446] Prec@1 [79.672] Prec@5 [95.374] 







- **resnet101融合结果**

| fusion策略        | top1                   | top5    |
| --------------- | ---------------------- | ------- |
| average         | 88.3162                | 98.0439 |
| max             | 80.3859                | 95.0833 |
| 加权均值(空域取1，时域取2) | 84.8533                | 97.1716 |
| 加权均值(空域取2，时域取1) | $\color{red}{90.2987}$ | 98.5726 |



























